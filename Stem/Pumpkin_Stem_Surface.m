% Pumpkin Stem
function Pumpkin_Stem_Surface(Gen_Stl, null)
    load Stem_Control_Points.mat;
    % u first

    Dx = [P1(1,1)  P1(2,1)  P1(3,1)  P1(4,1)  P1(5,1)  P1(6,1)  P1(7,1)  P1(8,1)  P1(9,1)  P1(10,1)  P1(11,1)  P1(12,1)  P1(13,1)  P1(14,1)  P1(15,1)  P1(16,1)  P1(17,1)  P1(18,1)  P1(19,1)  P1(20,1)  P1(21,1)  P1(22,1)  P1(23,1)  P1(24,1);       
          P2(1,1)  P2(2,1)  P2(3,1)  P2(4,1)  P2(5,1)  P2(6,1)  P2(7,1)  P2(8,1)  P2(9,1)  P2(10,1)  P2(11,1)  P2(12,1)  P2(13,1)  P2(14,1)  P2(15,1)  P2(16,1)  P2(17,1)  P2(18,1)  P2(19,1)  P2(20,1)  P2(21,1)  P2(22,1)  P2(23,1)  P2(24,1);
          P3(1,1)  P3(2,1)  P3(3,1)  P3(4,1)  P3(5,1)  P3(6,1)  P3(7,1)  P3(8,1)  P3(9,1)  P3(10,1)  P3(11,1)  P3(12,1)  P3(13,1)  P3(14,1)  P3(15,1)  P3(16,1)  P3(17,1)  P3(18,1)  P3(19,1)  P3(20,1)  P3(21,1)  P3(22,1)  P3(23,1)  P3(24,1);
          P4(1,1)  P4(2,1)  P4(3,1)  P4(4,1)  P4(5,1)  P4(6,1)  P4(7,1)  P4(8,1)  P4(9,1)  P4(10,1)  P4(11,1)  P4(12,1)  P4(13,1)  P4(14,1)  P4(15,1)  P4(16,1)  P4(17,1)  P4(18,1)  P4(19,1)  P4(20,1)  P4(21,1)  P4(22,1)  P4(23,1)  P4(24,1);
          P5(1,1)  P5(2,1)  P5(3,1)  P5(4,1)  P5(5,1)  P5(6,1)  P5(7,1)  P5(8,1)  P5(9,1)  P5(10,1)  P5(11,1)  P5(12,1)  P5(13,1)  P5(14,1)  P5(15,1)  P5(16,1)  P5(17,1)  P5(18,1)  P5(19,1)  P5(20,1)  P5(21,1)  P5(22,1)  P5(23,1)  P5(24,1);
          P6(1,1)  P6(2,1)  P6(3,1)  P6(4,1)  P6(5,1)  P6(6,1)  P6(7,1)  P6(8,1)  P6(9,1)  P6(10,1)  P6(11,1)  P6(12,1)  P6(13,1)  P6(14,1)  P6(15,1)  P6(16,1)  P6(17,1)  P6(18,1)  P6(19,1)  P6(20,1)  P6(21,1)  P6(22,1)  P6(23,1)  P6(24,1);
          P7(1,1)  P7(2,1)  P7(3,1)  P7(4,1)  P7(5,1)  P7(6,1)  P7(7,1)  P7(8,1)  P7(9,1)  P7(10,1)  P7(11,1)  P7(12,1)  P7(13,1)  P7(14,1)  P7(15,1)  P7(16,1)  P7(17,1)  P7(18,1)  P7(19,1)  P7(20,1)  P7(21,1)  P7(22,1)  P7(23,1)  P7(24,1);
          P8(1,1)  P8(2,1)  P8(3,1)  P8(4,1)  P8(5,1)  P8(6,1)  P8(7,1)  P8(8,1)  P8(9,1)  P8(10,1)  P8(11,1)  P8(12,1)  P8(13,1)  P8(14,1)  P8(15,1)  P8(16,1)  P8(17,1)  P8(18,1)  P8(19,1)  P8(20,1)  P8(21,1)  P8(22,1)  P8(23,1)  P8(24,1);
          P9(1,1)  P9(2,1)  P9(3,1)  P9(4,1)  P9(5,1)  P9(6,1)  P9(7,1)  P9(8,1)  P9(9,1)  P9(10,1)  P9(11,1)  P9(12,1)  P9(13,1)  P9(14,1)  P9(15,1)  P9(16,1)  P9(17,1)  P9(18,1)  P9(19,1)  P9(20,1)  P9(21,1)  P9(22,1)  P9(23,1)  P9(24,1);
          P10(1,1) P10(2,1) P10(3,1) P10(4,1) P10(5,1) P10(6,1) P10(7,1) P10(8,1) P10(9,1) P10(10,1) P10(11,1) P10(12,1) P10(13,1) P10(14,1) P10(15,1) P10(16,1) P10(17,1) P10(18,1) P10(19,1) P10(20,1) P10(21,1) P10(22,1) P10(23,1) P10(24,1);
          P11(1,1) P11(2,1) P11(3,1) P11(4,1) P11(5,1) P11(6,1) P11(7,1) P11(8,1) P11(9,1) P11(10,1) P11(11,1) P11(12,1) P11(13,1) P11(14,1) P11(15,1) P11(16,1) P11(17,1) P11(18,1) P11(19,1) P11(20,1) P11(21,1) P11(22,1) P11(23,1) P11(24,1);
          P12(1,1) P12(2,1) P12(3,1) P12(4,1) P12(5,1) P12(6,1) P12(7,1) P12(8,1) P12(9,1) P12(10,1) P12(11,1) P12(12,1) P12(13,1) P12(14,1) P12(15,1) P12(16,1) P12(17,1) P12(18,1) P12(19,1) P12(20,1) P12(21,1) P12(22,1) P12(23,1) P12(24,1);
          P13(1,1) P13(2,1) P13(3,1) P13(4,1) P13(5,1) P13(6,1) P13(7,1) P13(8,1) P13(9,1) P13(10,1) P13(11,1) P13(12,1) P13(13,1) P13(14,1) P13(15,1) P13(16,1) P13(17,1) P13(18,1) P13(19,1) P13(20,1) P13(21,1) P13(22,1) P13(23,1) P13(24,1);
          P14(1,1) P14(2,1) P14(3,1) P14(4,1) P14(5,1) P14(6,1) P14(7,1) P14(8,1) P14(9,1) P14(10,1) P14(11,1) P14(12,1) P14(13,1) P14(14,1) P14(15,1) P14(16,1) P14(17,1) P14(18,1) P14(19,1) P14(20,1) P14(21,1) P14(22,1) P14(23,1) P14(24,1);
          P15(18,1) P15(17,1) P15(16,1) P15(15,1) P15(14,1) P15(13,1) P15(12,1) P15(11,1) P15(10,1) P15(9,1) P15(8,1) P15(7,1) P15(6,1) P15(5,1) P15(4,1) P15(3,1) P15(2,1) P15(24,1) P15(23,1) P15(22,1) P15(21,1) P15(20,1) P15(19,1) P15(18,1);
          P16(18,1) P16(17,1) P16(16,1) P16(15,1) P16(14,1) P16(13,1) P16(12,1) P16(11,1) P16(10,1) P16(9,1) P16(8,1) P16(7,1) P16(6,1) P16(5,1) P16(4,1) P16(3,1) P16(2,1) P16(24,1) P16(23,1) P16(22,1) P16(21,1) P16(20,1) P16(19,1) P16(18,1);
          P17(18,1) P17(17,1) P17(16,1) P17(15,1) P17(14,1) P17(13,1) P17(12,1) P17(11,1) P17(10,1) P17(9,1) P17(8,1) P17(7,1) P17(6,1) P17(5,1) P17(4,1) P17(3,1) P17(2,1) P17(24,1) P17(23,1) P17(22,1) P17(21,1) P17(20,1) P17(19,1) P17(18,1);
          P18(18,1) P18(17,1) P18(16,1) P18(15,1) P18(14,1) P18(13,1) P18(12,1) P18(11,1) P18(10,1) P18(9,1) P18(8,1) P18(7,1) P18(6,1) P18(5,1) P18(4,1) P18(3,1) P18(2,1) P18(24,1) P18(23,1) P18(22,1) P18(21,1) P18(20,1) P18(19,1) P18(18,1);
          P19(18,1) P19(17,1) P19(16,1) P19(15,1) P19(14,1) P19(13,1) P19(12,1) P19(11,1) P19(10,1) P19(9,1) P19(8,1) P19(7,1) P19(6,1) P19(5,1) P19(4,1) P19(3,1) P19(2,1) P19(24,1) P19(23,1) P19(22,1) P19(21,1) P19(20,1) P19(19,1) P19(18,1)];

    Dy = [P1(1,2)  P1(2,2)  P1(3,2)  P1(4,2)  P1(5,2)  P1(6,2)  P1(7,2)  P1(8,2)  P1(9,2)  P1(10,2)  P1(11,2)  P1(12,2)  P1(13,2)  P1(14,2)  P1(15,2)  P1(16,2)  P1(17,2)  P1(18,2)  P1(19,2)  P1(20,2)  P1(21,2)  P1(22,2)  P1(23,2)  P1(24,2);       
          P2(1,2)  P2(2,2)  P2(3,2)  P2(4,2)  P2(5,2)  P2(6,2)  P2(7,2)  P2(8,2)  P2(9,2)  P2(10,2)  P2(11,2)  P2(12,2)  P2(13,2)  P2(14,2)  P2(15,2)  P2(16,2)  P2(17,2)  P2(18,2)  P2(19,2)  P2(20,2)  P2(21,2)  P2(22,2)  P2(23,2)  P2(24,2);
          P3(1,2)  P3(2,2)  P3(3,2)  P3(4,2)  P3(5,2)  P3(6,2)  P3(7,2)  P3(8,2)  P3(9,2)  P3(10,2)  P3(11,2)  P3(12,2)  P3(13,2)  P3(14,2)  P3(15,2)  P3(16,2)  P3(17,2)  P3(18,2)  P3(19,2)  P3(20,2)  P3(21,2)  P3(22,2)  P3(23,2)  P3(24,2);
          P4(1,2)  P4(2,2)  P4(3,2)  P4(4,2)  P4(5,2)  P4(6,2)  P4(7,2)  P4(8,2)  P4(9,2)  P4(10,2)  P4(11,2)  P4(12,2)  P4(13,2)  P4(14,2)  P4(15,2)  P4(16,2)  P4(17,2)  P4(18,2)  P4(19,2)  P4(20,2)  P4(21,2)  P4(22,2)  P4(23,2)  P4(24,2);
          P5(1,2)  P5(2,2)  P5(3,2)  P5(4,2)  P5(5,2)  P5(6,2)  P5(7,2)  P5(8,2)  P5(9,2)  P5(10,2)  P5(11,2)  P5(12,2)  P5(13,2)  P5(14,2)  P5(15,2)  P5(16,2)  P5(17,2)  P5(18,2)  P5(19,2)  P5(20,2)  P5(21,2)  P5(22,2)  P5(23,2)  P5(24,2);
          P6(1,2)  P6(2,2)  P6(3,2)  P6(4,2)  P6(5,2)  P6(6,2)  P6(7,2)  P6(8,2)  P6(9,2)  P6(10,2)  P6(11,2)  P6(12,2)  P6(13,2)  P6(14,2)  P6(15,2)  P6(16,2)  P6(17,2)  P6(18,2)  P6(19,2)  P6(20,2)  P6(21,2)  P6(22,2)  P6(23,2)  P6(24,2);
          P7(1,2)  P7(2,2)  P7(3,2)  P7(4,2)  P7(5,2)  P7(6,2)  P7(7,2)  P7(8,2)  P7(9,2)  P7(10,2)  P7(11,2)  P7(12,2)  P7(13,2)  P7(14,2)  P7(15,2)  P7(16,2)  P7(17,2)  P7(18,2)  P7(19,2)  P7(20,2)  P7(21,2)  P7(22,2)  P7(23,2)  P7(24,2);
          P8(1,2)  P8(2,2)  P8(3,2)  P8(4,2)  P8(5,2)  P8(6,2)  P8(7,2)  P8(8,2)  P8(9,2)  P8(10,2)  P8(11,2)  P8(12,2)  P8(13,2)  P8(14,2)  P8(15,2)  P8(16,2)  P8(17,2)  P8(18,2)  P8(19,2)  P8(20,2)  P8(21,2)  P8(22,2)  P8(23,2)  P8(24,2);
          P9(1,2)  P9(2,2)  P9(3,2)  P9(4,2)  P9(5,2)  P9(6,2)  P9(7,2)  P9(8,2)  P9(9,2)  P9(10,2)  P9(11,2)  P9(12,2)  P9(13,2)  P9(14,2)  P9(15,2)  P9(16,2)  P9(17,2)  P9(18,2)  P9(19,2)  P9(20,2)  P9(21,2)  P9(22,2)  P9(23,2)  P9(24,2);
          P10(1,2) P10(2,2) P10(3,2) P10(4,2) P10(5,2) P10(6,2) P10(7,2) P10(8,2) P10(9,2) P10(10,2) P10(11,2) P10(12,2) P10(13,2) P10(14,2) P10(15,2) P10(16,2) P10(17,2) P10(18,2) P10(19,2) P10(20,2) P10(21,2) P10(22,2) P10(23,2) P10(24,2);
          P11(1,2) P11(2,2) P11(3,2) P11(4,2) P11(5,2) P11(6,2) P11(7,2) P11(8,2) P11(9,2) P11(10,2) P11(11,2) P11(12,2) P11(13,2) P11(14,2) P11(15,2) P11(16,2) P11(17,2) P11(18,2) P11(19,2) P11(20,2) P11(21,2) P11(22,2) P11(23,2) P11(24,2);
          P12(1,2) P12(2,2) P12(3,2) P12(4,2) P12(5,2) P12(6,2) P12(7,2) P12(8,2) P12(9,2) P12(10,2) P12(11,2) P12(12,2) P12(13,2) P12(14,2) P12(15,2) P12(16,2) P12(17,2) P12(18,2) P12(19,2) P12(20,2) P12(21,2) P12(22,2) P12(23,2) P12(24,2);
          P13(1,2) P13(2,2) P13(3,2) P13(4,2) P13(5,2) P13(6,2) P13(7,2) P13(8,2) P13(9,2) P13(10,2) P13(11,2) P13(12,2) P13(13,2) P13(14,2) P13(15,2) P13(16,2) P13(17,2) P13(18,2) P13(19,2) P13(20,2) P13(21,2) P13(22,2) P13(23,2) P13(24,2);
          P14(1,2) P14(2,2) P14(3,2) P14(4,2) P14(5,2) P14(6,2) P14(7,2) P14(8,2) P14(9,2) P14(10,2) P14(11,2) P14(12,2) P14(13,2) P14(14,2) P14(15,2) P14(16,2) P14(17,2) P14(18,2) P14(19,2) P14(20,2) P14(21,2) P14(22,2) P14(23,2) P14(24,2);
          P15(18,2) P15(17,2) P15(16,2) P15(15,2) P15(14,2) P15(13,2) P15(12,2) P15(11,2) P15(10,2) P15(9,2) P15(8,2) P15(7,2) P15(6,2) P15(5,2) P15(4,2) P15(3,2) P15(2,2) P15(24,2) P15(23,2) P15(22,2) P15(21,2) P15(20,2) P15(19,2) P15(18,2);
          P16(18,2) P16(17,2) P16(16,2) P16(15,2) P16(14,2) P16(13,2) P16(12,2) P16(11,2) P16(10,2) P16(9,2) P16(8,2) P16(7,2) P16(6,2) P16(5,2) P16(4,2) P16(3,2) P16(2,2) P16(24,2) P16(23,2) P16(22,2) P16(21,2) P16(20,2) P16(19,2) P16(18,2);
          P17(18,2) P17(17,2) P17(16,2) P17(15,2) P17(14,2) P17(13,2) P17(12,2) P17(11,2) P17(10,2) P17(9,2) P17(8,2) P17(7,2) P17(6,2) P17(5,2) P17(4,2) P17(3,2) P17(2,2) P17(24,2) P17(23,2) P17(22,2) P17(21,2) P17(20,2) P17(19,2) P17(18,2);
          P18(18,2) P18(17,2) P18(16,2) P18(15,2) P18(14,2) P18(13,2) P18(12,2) P18(11,2) P18(10,2) P18(9,2) P18(8,2) P18(7,2) P18(6,2) P18(5,2) P18(4,2) P18(3,2) P18(2,2) P18(24,2) P18(23,2) P18(22,2) P18(21,2) P18(20,2) P18(19,2) P18(18,2);
          P19(18,2) P19(17,2) P19(16,2) P19(15,2) P19(14,2) P19(13,2) P19(12,2) P19(11,2) P19(10,2) P19(9,2) P19(8,2) P19(7,2) P19(6,2) P19(5,2) P19(4,2) P19(3,2) P19(2,2) P19(24,2) P19(23,2) P19(22,2) P19(21,2) P19(20,2) P19(19,2) P19(18,2)];

    Dz = [P1(1,3)  P1(2,3)  P1(3,3)  P1(4,3)  P1(5,3)  P1(6,3)  P1(7,3)  P1(8,3)  P1(9,3)  P1(10,3)  P1(11,3)  P1(12,3)  P1(13,3)  P1(14,3)  P1(15,3)  P1(16,3)  P1(17,3)  P1(18,3)  P1(19,3)  P1(20,3)  P1(21,3)  P1(22,3)  P1(23,3)  P1(24,3);
          P2(1,3)  P2(2,3)  P2(3,3)  P2(4,3)  P2(5,3)  P2(6,3)  P2(7,3)  P2(8,3)  P2(9,3)  P2(10,3)  P2(11,3)  P2(12,3)  P2(13,3)  P2(14,3)  P2(15,3)  P2(16,3)  P2(17,3)  P2(18,3)  P2(19,3)  P2(20,3)  P2(21,3)  P2(22,3)  P2(23,3)  P2(24,3);
          P3(1,3)  P3(2,3)  P3(3,3)  P3(4,3)  P3(5,3)  P3(6,3)  P3(7,3)  P3(8,3)  P3(9,3)  P3(10,3)  P3(11,3)  P3(12,3)  P3(13,3)  P3(14,3)  P3(15,3)  P3(16,3)  P3(17,3)  P3(18,3)  P3(19,3)  P3(20,3)  P3(21,3)  P3(22,3)  P3(23,3)  P3(24,3);
          P4(1,3)  P4(2,3)  P4(3,3)  P4(4,3)  P4(5,3)  P4(6,3)  P4(7,3)  P4(8,3)  P4(9,3)  P4(10,3)  P4(11,3)  P4(12,3)  P4(13,3)  P4(14,3)  P4(15,3)  P4(16,3)  P4(17,3)  P4(18,3)  P4(19,3)  P4(20,3)  P4(21,3)  P4(22,3)  P4(23,3)  P4(24,3);
          P5(1,3)  P5(2,3)  P5(3,3)  P5(4,3)  P5(5,3)  P5(6,3)  P5(7,3)  P5(8,3)  P5(9,3)  P5(10,3)  P5(11,3)  P5(12,3)  P5(13,3)  P5(14,3)  P5(15,3)  P5(16,3)  P5(17,3)  P5(18,3)  P5(19,3)  P5(20,3)  P5(21,3)  P5(22,3)  P5(23,3)  P5(24,3);
          P6(1,3)  P6(2,3)  P6(3,3)  P6(4,3)  P6(5,3)  P6(6,3)  P6(7,3)  P6(8,3)  P6(9,3)  P6(10,3)  P6(11,3)  P6(12,3)  P6(13,3)  P6(14,3)  P6(15,3)  P6(16,3)  P6(17,3)  P6(18,3)  P6(19,3)  P6(20,3)  P6(21,3)  P6(22,3)  P6(23,3)  P6(24,3);
          P7(1,3)  P7(2,3)  P7(3,3)  P7(4,3)  P7(5,3)  P7(6,3)  P7(7,3)  P7(8,3)  P7(9,3)  P7(10,3)  P7(11,3)  P7(12,3)  P7(13,3)  P7(14,3)  P7(15,3)  P7(16,3)  P7(17,3)  P7(18,3)  P7(19,3)  P7(20,3)  P7(21,3)  P7(22,3)  P7(23,3)  P7(24,3);
          P8(1,3)  P8(2,3)  P8(3,3)  P8(4,3)  P8(5,3)  P8(6,3)  P8(7,3)  P8(8,3)  P8(9,3)  P8(10,3)  P8(11,3)  P8(12,3)  P8(13,3)  P8(14,3)  P8(15,3)  P8(16,3)  P8(17,3)  P8(18,3)  P8(19,3)  P8(20,3)  P8(21,3)  P8(22,3)  P8(23,3)  P8(24,3);
          P9(1,3)  P9(2,3)  P9(3,3)  P9(4,3)  P9(5,3)  P9(6,3)  P9(7,3)  P9(8,3)  P9(9,3)  P9(10,3)  P9(11,3)  P9(12,3)  P9(13,3)  P9(14,3)  P9(15,3)  P9(16,3)  P9(17,3)  P9(18,3)  P9(19,3)  P9(20,3)  P9(21,3)  P9(22,3)  P9(23,3)  P9(24,3);
          P10(1,3) P10(2,3) P10(3,3) P10(4,3) P10(5,3) P10(6,3) P10(7,3) P10(8,3) P10(9,3) P10(10,3) P10(11,3) P10(12,3) P10(13,3) P10(14,3) P10(15,3) P10(16,3) P10(17,3) P10(18,3) P10(19,3) P10(20,3) P10(21,3) P10(22,3) P10(23,3) P10(24,3);
          P11(1,3) P11(2,3) P11(3,3) P11(4,3) P11(5,3) P11(6,3) P11(7,3) P11(8,3) P11(9,3) P11(10,3) P11(11,3) P11(12,3) P11(13,3) P11(14,3) P11(15,3) P11(16,3) P11(17,3) P11(18,3) P11(19,3) P11(20,3) P11(21,3) P11(22,3) P11(23,3) P11(24,3);
          P12(1,3) P12(2,3) P12(3,3) P12(4,3) P12(5,3) P12(6,3) P12(7,3) P12(8,3) P12(9,3) P12(10,3) P12(11,3) P12(12,3) P12(13,3) P12(14,3) P12(15,3) P12(16,3) P12(17,3) P12(18,3) P12(19,3) P12(20,3) P12(21,3) P12(22,3) P12(23,3) P12(24,3);
          P13(1,3) P13(2,3) P13(3,3) P13(4,3) P13(5,3) P13(6,3) P13(7,3) P13(8,3) P13(9,3) P13(10,3) P13(11,3) P13(12,3) P13(13,3) P13(14,3) P13(15,3) P13(16,3) P13(17,3) P13(18,3) P13(19,3) P13(20,3) P13(21,3) P13(22,3) P13(23,3) P13(24,3);
          P14(1,3) P14(2,3) P14(3,3) P14(4,3) P14(5,3) P14(6,3) P14(7,3) P14(8,3) P14(9,3) P14(10,3) P14(11,3) P14(12,3) P14(13,3) P14(14,3) P14(15,3) P14(16,3) P14(17,3) P14(18,3) P14(19,3) P14(20,3) P14(21,3) P14(22,3) P14(23,3) P14(24,3);
          P15(18,3) P15(17,3) P15(16,3) P15(15,3) P15(14,3) P15(13,3) P15(12,3) P15(11,3) P15(10,3) P15(9,3) P15(8,3) P15(7,3) P15(6,3) P15(5,3) P15(4,3) P15(3,3) P15(2,3) P15(24,3) P15(23,3) P15(22,3) P15(21,3) P15(20,3) P15(19,3) P15(18,3);
          P16(18,3) P16(17,3) P16(16,3) P16(15,3) P16(14,3) P16(13,3) P16(12,3) P16(11,3) P16(10,3) P16(9,3) P16(8,3) P16(7,3) P16(6,3) P16(5,3) P16(4,3) P16(3,3) P16(2,3) P16(24,3) P16(23,3) P16(22,3) P16(21,3) P16(20,3) P16(19,3) P16(18,3);
          P17(18,3) P17(17,3) P17(16,3) P17(15,3) P17(14,3) P17(13,3) P17(12,3) P17(11,3) P17(10,3) P17(9,3) P17(8,3) P17(7,3) P17(6,3) P17(5,3) P17(4,3) P17(3,3) P17(2,3) P17(24,3) P17(23,3) P17(22,3) P17(21,3) P17(20,3) P17(19,3) P17(18,3);
          P18(18,3) P18(17,3) P18(16,3) P18(15,3) P18(14,3) P18(13,3) P18(12,3) P18(11,3) P18(10,3) P18(9,3) P18(8,3) P18(7,3) P18(6,3) P18(5,3) P18(4,3) P18(3,3) P18(2,3) P18(24,3) P18(23,3) P18(22,3) P18(21,3) P18(20,3) P18(19,3) P18(18,3);
          P19(18,3) P19(17,3) P19(16,3) P19(15,3) P19(14,3) P19(13,3) P19(12,3) P19(11,3) P19(10,3) P19(9,3) P19(8,3) P19(7,3) P19(6,3) P19(5,3) P19(4,3) P19(3,3) P19(2,3) P19(24,3) P19(23,3) P19(22,3) P19(21,3) P19(20,3) P19(19,3) P19(18,3)];


    ku=4;
    kv=4;
    nu=24;
    nv=19;

    hold on;
    %plot3(Dx,Dy,Dz,'r:s', 'MarkerFaceColor', 'r', 'MarkerSize',8);
    %plot3(Dx',Dy',Dz','r:s', 'MarkerFaceColor', 'r', 'MarkerSize',8);
    [Px,Py,Pz,U,V] = BsplineSurfInter(Dx,Dy,Dz,ku,kv,nu,nv);
    w = ones(19,24);
    CP = cat(3,Px',Py',Pz');
    CP = shiftdim(CP,2);


    num = 20; % 80;

    plotNUBSsurface(ku-1,kv-1,U,V,CP,num);

    CPS = cat(3,Px', Py', Pz',w');
    CPS = shiftdim(CPS,2);

    k1 = ku;
    k2 = kv;
    nrbs.type   = 'Surface';
    nrbs.number = [nu, nv];
    nrbs.coefs = CPS ;  % CPs in homogeneous coordinates
    nrbs.knots = {U, V};
    nrbs.order = [k1 k2];

    % Convert the resulting surface into an IGES file
    % Matlab converts matrix into a linear list via row-first.
    % nCP = cat(2, reshape(Px,[nu*nv,1]),...
    %      reshape(Py,[nu*nv,1]), reshape(Pz,[nu*nv,1]));
    % bsplineSurf2IGES(U, V, ku, kv,...
    %         nu, nv, nCP, 'surfInterp.igs')

    if Gen_Stl == true 
        fileStl = 'stem.stl';
        [tri,vtx]=buildTriVtx(nrbs,[100,100]); % triangulate NURBS
        writeSTL(fileStl,'nW',tri,vtx,'mode','ascii'); % write STL
    %     [vtx,tri]=readSTL(fileStl,'y');% read STL file
    end
end
